# üìã –°—Ç–∞–Ω–¥–∞—Ä—Ç –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –ú–µ–∂–¥—É –°–µ—Ä–≤–∏—Å–∞–º–∏

[‚¨ÖÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é][backlink-index]

<!-- doc-deps
id: standard-service-dependencies
depends_on:
  - knowledge/standards/standard-specification-common-format.md
provides_for:
  - knowledge/standards/standard-service-specification.md
  - knowledge/standards/standard-feature-specification.md
  - knowledge/services/*/service-*.md
  - knowledge/features/*/feature-*.md
-->

–≠—Ç–æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–¥—Ö–æ–¥ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—é, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ `pihanya-hawk`. –°—Ç–∞–Ω–¥–∞—Ä—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

---

## üìò –¶–µ–ª—å

- –û–±–µ—Å–ø–µ—á–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å cascading failures –∏–∑-–∑–∞ –Ω–µ—É—á—Ç–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è API –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –°–æ–∑–¥–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ü–µ–Ω–∫–∏ blast radius –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üèóÔ∏è –¢–∏–ø—ã –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –¢–∏–ø                | –û–ø–∏—Å–∞–Ω–∏–µ                                                   | –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏                       | –ü—Ä–∏–º–µ—Ä                    |
| :----------------- | :--------------------------------------------------------- | :------------------------------------------------ | :------------------------ |
| **Hard**           | –°–µ—Ä–≤–∏—Å –Ω–µ –º–æ–∂–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏            | –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–ª–∏ –∞–≤–∞—Ä–∏–π–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è    | `open-webui` ‚Üí `vllm`     |
| **Soft**           | –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, –Ω–æ –±–∞–∑–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è | Graceful degradation, fallback –∫ –∫—ç—à—É –∏–ª–∏ —Å—Ç–∞—Ç–∏–∫–µ | UI –±–µ–∑ analytics —Å–µ—Ä–≤–∏—Å–∞  |
| **Eventual**       | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –¥–æ–ø—É—Å—Ç–∏–º—ã –∑–∞–¥–µ—Ä–∂–∫–∏                 | –û—á–µ—Ä–µ–¥—å –∑–∞–ø—Ä–æ—Å–æ–≤, —Ä–µ—Ç—Ä–∞–∏ —Å exponential backoff    | Event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  |
| **Infrastructure** | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤                | –°–µ—Ä–≤–∏—Å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç                    | `host_volume`, GPU device |

### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é

| –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ    | –û–ø–∏—Å–∞–Ω–∏–µ                          | –ü—Ä–∏–º–µ—Ä                                   |
| :------------- | :-------------------------------- | :--------------------------------------- |
| **Upstream**   | –°–µ—Ä–≤–∏—Å –≤—ã–∑—ã–≤–∞–µ—Ç –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–∏—Å     | `open-webui` –≤—ã–∑—ã–≤–∞–µ—Ç `vllm` API         |
| **Downstream** | –°–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–∞–µ—Ç –≤—ã–∑–æ–≤—ã –æ—Ç –¥—Ä—É–≥–æ–≥–æ | `vllm` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç `open-webui` |

### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ä–µ–∂–∏–º—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

| –†–µ–∂–∏–º            | –û–ø–∏—Å–∞–Ω–∏–µ                                  | –ü—Ä–∏–º–µ—Ä                |
| :--------------- | :---------------------------------------- | :-------------------- |
| **Synchronous**  | –ë–ª–æ–∫–∏—Ä—É—é—â–∏–π –≤—ã–∑–æ–≤ —Å –æ–∂–∏–¥–∞–Ω–∏–µ–º –æ—Ç–≤–µ—Ç–∞      | REST API –≤—ã–∑–æ–≤—ã       |
| **Asynchronous** | –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π –≤—ã–∑–æ–≤ —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å/—Å–æ–±—ã—Ç–∏—è | Kafka, message queues |

### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏

| –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ –≤–ª–∏—è–Ω–∏—è                                           |
| :---------- | :--------------------------------------------------------- |
| **Critical**| –ü–æ—Ç–µ—Ä—è –∫–ª—é—á–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞ |
| **High**    | –°—É—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤                |
| **Medium**  | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è —á–∞—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏             |
| **Low**     | –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤   |

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. Dependency Map (–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª)

–ö–∞–∂–¥–∞—è —Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (`service-<name>.md`) –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–∑–¥–µ–ª **"üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏"** —Å —Ç–∞–±–ª–∏—Ü–µ–π —Ñ–æ—Ä–º–∞—Ç–∞:

```markdown
## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å        | –¢–∏–ø            | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –ö–æ–Ω—Ç—Ä–∞–∫—Ç/–í–µ—Ä—Å–∏—è                      | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏                               |
| :----------------- | :------------- | :---------- | :----------------------------------- | :---------- | :------------------------------------------------- |
| `vllm-deepseek-r1` | Hard           | Upstream    | REST API v1                          | Critical    | `curl -fsS http://pihanya-hawk.local:18000/health` |
| `nomad`            | Infrastructure | Upstream    | Host volume `open-webui-data`        | Critical    | –ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ (deploy-time)                         |
| `zfs`              | Infrastructure | Upstream    | Dataset `/data/hawk/data/open-webui` | High        | Directory exists with correct permissions          |
```

### –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã

| –ü–æ–ª–µ                     | –û–ø–∏—Å–∞–Ω–∏–µ                                          | –ü—Ä–∏–º–µ—Ä—ã                                      |
| :----------------------- | :------------------------------------------------ | :------------------------------------------- |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å**          | –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –∏–ª–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ | `vllm`, `nomad`, `postgresql`                |
| **–¢–∏–ø**                  | –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π enum)        | `Hard`, `Soft`, `Eventual`, `Infrastructure` |
| **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**          | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞         | `Upstream`, `Downstream`                     |
| **–ö–æ–Ω—Ç—Ä–∞–∫—Ç/–í–µ—Ä—Å–∏—è**      | –í–µ—Ä—Å–∏—è API, —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö, —Å—Ö–µ–º–∞ –ë–î               | `REST API v1`, `Protobuf v3`                 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**          | –°—Ç–µ–ø–µ–Ω—å –≤–ª–∏—è–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–∏—Å (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π enum)    | `Critical`, `High`, `Medium`, `Low`          |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏** | –ö–æ–º–∞–Ω–¥–∞ –∏–ª–∏ –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏                        | `curl`, `nc -z`, Nomad health check          |

### –ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ enum-–∑–Ω–∞—á–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)

- `–¢–∏–ø`: —Ç–æ–ª—å–∫–æ `Hard`, `Soft`, `Eventual`, `Infrastructure`
- `–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ`: —Ç–æ–ª—å–∫–æ `Upstream`, `Downstream`
- `–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å`: —Ç–æ–ª—å–∫–æ `Critical`, `High`, `Medium`, `Low`

---

## üîÑ –ü–æ—Ä—è–¥–æ–∫ –î–µ–ø–ª–æ—è (Deployment Order)

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞

```mermaid
flowchart TD
    S1["1. Infrastructure First: host_volume, GPU, —Å–µ—Ç—å"]
    S2["2. Deploy Root Upstream Services: –±–µ–∑ Hard Upstream –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"]
    S3["3. Deploy Dependent Services: —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫ –ø–æ Hard Upstream"]
    S4["4. Deploy Edge Services: UI, API gateways, –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞"]
    S5["5. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è readiness-–ø—Ä–æ–≤–µ—Ä–∫–∞"]
    S1 --> S2 --> S3 --> S4 --> S5
```

### –§–æ—Ä–º–∞—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞

–î–ª—è feature, –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—â–µ–π –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤, –≤ Hub –¥–æ–∫—É–º–µ–Ω—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑–∞—Ç—å **Deployment Sequence**:

```markdown
## üöÄ Deployment Sequence

| –ü–æ—Ä—è–¥–æ–∫ | –°–µ—Ä–≤–∏—Å             | –î–µ–π—Å—Ç–≤–∏–µ        | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º |
| :------ | :----------------- | :-------------- | :----------------------------- |
| 1       | `vllm-deepseek-r1` | Deploy jobspec  | Health check: `/health`        |
| 2       | `open-webui`       | Deploy jobspec  | UI –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8080      |
| 3       | `integration-test` | Run smoke tests | –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç             |
```

### Dependency Graph

–î–ª—è —Å–ª–æ–∂–Ω—ã—Ö feature —Å –±–æ–ª–µ–µ —á–µ–º 3 —Å–µ—Ä–≤–∏—Å–∞–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:

```mermaid
flowchart TB
    OpenWebUi["open-webui (UI Layer)"] -->|Hard: REST API v1| Vllm["vllm-deepseek-r1 (Inference)"]
    Vllm -->|Infrastructure: Host Volume| Dataset["ZFS Dataset: vllm-models"]
```

---

## üí• Blast Radius Analysis

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**Blast Radius** ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

### –§–æ—Ä–º–∞—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–í Hub –¥–æ–∫—É–º–µ–Ω—Ç–µ —Ñ–∏—á–∏ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª:

```markdown
## üí• Blast Radius

–ò–∑–º–µ–Ω–µ–Ω–∏–µ `vllm-deepseek-r1` –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç:

### –ü—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Direct)

| –°–µ—Ä–≤–∏—Å       | –í–ª–∏—è–Ω–∏–µ                                | Mitigation                           |
| :----------- | :------------------------------------- | :----------------------------------- |
| `open-webui` | –ü–æ–ª–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ | Health check, graceful error message |
| `llamacpp`   | –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π inference endpoint         | None (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω)                    |

### –ö–æ—Å–≤–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Indirect)

| –°–µ—Ä–≤–∏—Å      | –ü—É—Ç—å –≤–ª–∏—è–Ω–∏—è         | –°—Ç–µ–ø–µ–Ω—å —Ä–∏—Å–∫–∞ |
| :---------- | :------------------- | :------------ |
| (End users) | `open-webui` ‚Üí Users | –í—ã—Å–æ–∫–∞—è       |

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç            | –¢–∏–ø —Ä–∏—Å–∫–∞                  | –ü—Ä–æ–≤–µ—Ä–∫–∞                  |
| :------------------- | :------------------------- | :------------------------ |
| GPU device           | –°–µ—Ä–≤–∏—Å –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç –±–µ–∑ GPU | `nomad node status`       |
| `vllm-models` volume | –î–æ–ª–≥–∏–π cold start          | Pre-flight downloader job |
```

### –ú–∞—Ç—Ä–∏—Ü–∞ –≤–ª–∏—è–Ω–∏—è (Impact Matrix)

```markdown
| –ò–∑–º–µ–Ω—è–µ–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | Downstream Impact  | User Impact | Rollback Complexity    |
| :------------------- | :----------------- | :---------- | :--------------------- |
| `vllm` API contract  | High (all clients) | Critical    | High (model reload)    |
| `vllm` model version | High               | Medium      | Medium (config update) |
| `open-webui` UI      | Low (independent)  | Low         | Low (quick restart)    |
```

---

## üìú API Contract Management

### –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Semantic Versioning** –¥–ª—è API:

| –ò–∑–º–µ–Ω–µ–Ω–∏–µ                                              | –í–µ—Ä—Å–∏—è         | –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è                   |
| :----------------------------------------------------- | :------------- | :--------------------------- |
| Breaking changes (—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è) | Major (v2.0.0) | –°–æ–≤–º–µ—Å—Ç–∏–º—ã–π –ø–µ—Ä–∏–æ–¥, –º–∏–≥—Ä–∞—Ü–∏—è |
| –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π, —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)       | Minor (v1.1.0) | –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å       |
| Bug fixes, performance                                 | Patch (v1.0.1) | –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å         |

### Compatibility Matrix

–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–µ—Ä–≤–∏—Å–µ —Å downstream –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏:

```markdown
## üìã API Compatibility Matrix

| API Version    | `open-webui` –≤–µ—Ä—Å–∏–∏ | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è                      |
| :------------- | :------------------ | :------------------------------ |
| v1.0           | 0.7.x               | –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞               |
| v1.1           | 0.8.x               | –î–æ–±–∞–≤–ª–µ–Ω streaming              |
| v2.0 (planned) | 0.9.x+              | Breaking: –∏–∑–º–µ–Ω–µ–Ω —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ |
```

### Deprecation Policy

```markdown
## üö´ Deprecation Policy

1. **Announcement:** –ú–∏–Ω–∏–º—É–º 30 –¥–Ω–µ–π –¥–æ deprecation
2. **Sunset Period:** 90 –¥–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ deprecated –≤–µ—Ä—Å–∏–∏
3. **Communication:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ `#deployments` –∫–∞–Ω–∞–ª
4. **Monitoring:** –¢—Ä–µ–∫–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è deprecated endpoints

| Endpoint            | Deprecated Since | Sunset Date | Replacement                 |
| :------------------ | :--------------- | :---------- | :-------------------------- |
| `POST /v1/generate` | 2026-01-01       | 2026-04-01  | `POST /v1/chat/completions` |
```

---

## ‚úÖ Validation –∏ Health Checks

### Health Check Hierarchy

```mermaid
flowchart TD
    L1["Level 1: Infrastructure"]
    L1 --> L1A["Host volume available"]
    L1 --> L1B["GPU device present (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)"]
    L1 --> L1C["Network connectivity"]
    L2["Level 2: Service Readiness"]
    L2 --> L2A["Process running"]
    L2 --> L2B["Port listening"]
    L2 --> L2C["Dependencies responding"]
    L3["Level 3: Functional Health"]
    L3 --> L3A["Critical features operational"]
    L3 --> L3B["Performance within SLO"]
    L1 --> L2 --> L3
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

–í —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ (`service-<name>.md`):

```markdown
## ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Health Checks

### Upstream: `vllm-deepseek-r1`

| –ü—Ä–æ–≤–µ—Ä–∫–∞   | –ö–æ–º–∞–Ω–¥–∞                                               | –ß–∞—Å—Ç–æ—Ç–∞    | –¢–∞–π–º–∞—É—Ç |
| :--------- | :---------------------------------------------------- | :--------- | :------ |
| Liveness   | `curl -fsS http://pihanya-hawk.local:18000/health`    | –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ | 5s      |
| Readiness  | `curl -fsS http://pihanya-hawk.local:18000/v1/models` | 10s        | 10s     |
| Functional | –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å inference                             | 60s        | 30s     |

### Infrastructure: `host_volume`

| –ü—Ä–æ–≤–µ—Ä–∫–∞      | –ö–æ–º–∞–Ω–¥–∞              | –ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å |
| :------------ | :------------------- | :-------------- |
| Volume exists | Nomad job constraint | Plan phase      |
| Permissions   | `test -w /data/...`  | Pre-start task  |
| Capacity      | `df -h`              | Continuous      |
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Startup Order –≤ Nomad

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `lifecycle` hook –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:

```hcl
group "service-group" {
  # Pre-start task: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
  task "wait-for-deps" {
    lifecycle {
      hook = "prestart"
      sidecar = false
    }
    driver = "raw_exec"
    config {
      command = "/bin/bash"
      args = ["-c", "until curl -fsS http://vllm:18000/health; do sleep 5; done"]
    }
  }
  
  # Main application task
  task "app" {
    # ...
  }
}
```

---

## üß™ Integration Testing –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### Contract Testing

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏:

```markdown
## üß™ Integration Test: `open-webui` ‚Üí `vllm`

### Prerequisites

- `vllm-deepseek-r1` –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `192.168.1.99:18000`
- `open-webui` —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º `OPENAI_API_BASE_URL`

### Test Cases

| ID      | –û–ø–∏—Å–∞–Ω–∏–µ             | –ö–æ–º–∞–Ω–¥–∞/–®–∞–≥–∏                                                                               | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç                                                         |
| :------ | :------------------- | :----------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------- |
| INT-001 | Health cascade       | 1. `vllm` healthy<br>2. Start `open-webui`<br>3. Check UI                                  | UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "Backend Available"                                    |
| INT-002 | Graceful degradation | 1. Stop `vllm`<br>2. –ü–æ–ø—ã—Ç–∫–∞ —á–∞—Ç–∞ –≤ UI                                                     | UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ |
| INT-003 | Recovery             | 1. Stop `vllm`<br>2. –ü–æ–ø—ã—Ç–∫–∞ —á–∞—Ç–∞ (–æ–∂–∏–¥–∞–Ω–∏–µ –æ—à–∏–±–∫–∏)<br>3. Start `vllm`<br>4. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —á–∞—Ç | –ü–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è `vllm` —á–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç                                    |
```

### Automated Contract Tests

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```bash
#!/bin/bash
# scripts/test_dependency_openwebui_vllm.sh

set -euo pipefail

VLLM_URL="http://192.168.1.99:18000"
WEBUI_URL="http://192.168.1.99:8080"

echo "=== Testing vLLM Dependency ==="

# Test 1: Direct vLLM health
curl -fsS "${VLLM_URL}/health" > /dev/null && echo "‚úì vLLM healthy"

# Test 2: vLLM API contract
curl -fsS "${VLLM_URL}/v1/models" | jq -e '.data[].id' > /dev/null && echo "‚úì API contract valid"

# Test 3: Integration through Open WebUI
# (—Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ API endpoint)

exit 0
```

---

## üîÑ Change Management –¥–ª—è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –ü—Ä–æ—Ü–µ—Å—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

```mermaid
graph TD
    A[–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤ Upstream] --> B{Breaking Change?}
    B -->|No| C[Minor/Patch release]
    B -->|Yes| D[Major version bump]
    D --> E[Notify Downstream ]
    E --> F[Deprecation period]
    F --> G[Migration Guide]
    G --> H[Deployment]
```

### –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ Downstream Impact

–ü—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ upstream —Å–µ—Ä–≤–∏—Å–µ:

```markdown
## üîç Change Request: `vllm` API v2

### Blast Radius Checklist

- [ ] –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö downstream —Å–µ—Ä–≤–∏—Å–æ–≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
- [ ] –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –∫–∞–∂–¥—ã–º downstream –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞
- [ ] Deprecation timeline —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
- [ ] Rollback plan –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω
- [ ] Integration tests –æ–±–Ω–æ–≤–ª–µ–Ω—ã

### Downstream Impact

| –°–µ—Ä–≤–∏—Å          | –í–ª–∞–¥–µ–ª–µ—Ü  | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | –î–µ–π—Å—Ç–≤–∏—è                   |
| :-------------- | :-------- | :------------ | :------------------------- |
| `open-webui`    | @admin    | Breaking      | –û–±–Ω–æ–≤–∏—Ç—å –¥–æ v0.8+          |
| `custom-client` | @external | Breaking      | –£–≤–µ–¥–æ–º–∏—Ç—å, deprecation 90d |
```

---

## üìã Checklist –¥–ª—è –ù–æ–≤–æ–≥–æ –°–µ—Ä–≤–∏—Å–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—Å–µ upstream –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Hard, Soft, Eventual)
- [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—Å–µ infrastructure –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (volumes, GPU, network)
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ—Ä—è–¥–æ–∫ –¥–µ–ø–ª–æ—è
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –∫–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã

- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ API endpoints (–µ—Å–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç)
- [ ] –£–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä—Å–∏—è –∏ —Ñ–æ—Ä–º–∞—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- [ ] –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã breaking changes (–µ—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] Integration tests –¥–ª—è –≤—Å–µ—Ö Hard –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- [ ] Health checks –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ Nomad jobspec
- [ ] Graceful degradation –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è Soft –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### Blast Radius

- [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã downstream –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–∫—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç —ç—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å)
- [ ] –û—Ü–µ–Ω–µ–Ω impact –∏–∑–º–µ–Ω–µ–Ω–∏–π —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω rollback plan

---

## üèÜ Best Practices

### 1. –ò–∑–±–µ–≥–∞–π—Ç–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```mermaid
flowchart LR
    subgraph Bad["‚ùå –ü–ª–æ—Ö–æ"]
        A1["Service A"] --> B1["Service B"]
        B1 --> A1
    end
    subgraph Good["‚úÖ –•–æ—Ä–æ—à–æ"]
        B2["Service B"] --> A2["Service A"]
        C2["Service C (shared dependency)"] --> B2
        C2 --> A2
    end
```

### 2. Resilience Controls –¥–ª—è Hard –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö upstream –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```text
–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π baseline:
- Timeout –Ω–∞ –≤—ã–∑–æ–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- Retry —Å exponential backoff –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ–ø—ã—Ç–æ–∫
- Circuit breaker (Open –ø–æ—Å–ª–µ N –Ω–µ—É–¥–∞—á, Half-Open probe)
- Fallback –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
```

### 3. Async –¥–ª—è Eventual –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```markdown
–î–ª—è Eventual –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- Message queues –≤–º–µ—Å—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
- Retry policy —Å exponential backoff
- Dead letter queue –¥–ª—è failed messages
- Idempotency keys –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
```

### 4. Dependency Inversion Principle

```markdown
–°–µ—Ä–≤–∏—Å—ã –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –¥–µ—Ç–∞–ª–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
—Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∏–∂–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è. –û–±–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π (API –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤).
```

### 5. –ò–∑–æ–ª—è—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```text
–ï—Å–ª–∏ Service A –∏–º–µ–µ—Ç Hard –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç Service B:
- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç—å –∏—Ö –≤ –æ–¥–Ω–æ–º Nomad datacenter
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å affinity/anti-affinity rules –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∫–∞–∫ –µ–¥–∏–Ω—É—é unit of deployment
```

---

## üìö –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –ü—Ä–æ–µ–∫—Ç–∞

### –ü—Ä–∏–º–µ—Ä 1: `open-webui` Dependencies

```markdown
## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å        | –¢–∏–ø            | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –ö–æ–Ω—Ç—Ä–∞–∫—Ç                             | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ü—Ä–æ–≤–µ—Ä–∫–∞                                           |
| :----------------- | :------------- | :---------- | :----------------------------------- | :---------- | :------------------------------------------------- |
| `vllm-deepseek-r1` | Hard           | Upstream    | REST API v1                          | Critical    | `curl -fsS http://pihanya-hawk.local:18000/health` |
| `nomad`            | Infrastructure | Upstream    | Host volume `open-webui-data`        | Critical    | Nomad constraint                                   |
| `zfs`              | Infrastructure | Upstream    | Dataset `/data/hawk/data/open-webui` | High        | Pre-start check                                    |
| `host-network`     | Infrastructure | Upstream    | Port 8080 –¥–æ—Å—Ç—É–ø–µ–Ω                   | High        | Netstat check                                      |

## üöÄ Deployment Sequence

| –ü–æ—Ä—è–¥–æ–∫ | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç          | –î–µ–π—Å—Ç–≤–∏–µ                 | –ü—Ä–æ–≤–µ—Ä–∫–∞                            |
| :------ | :----------------- | :----------------------- | :---------------------------------- |
| 1       | ZFS dataset        | –°–æ–∑–¥–∞—Ç—å –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | `ls -ld /data/hawk/data/open-webui` |
| 2       | Nomad volume       | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é   | `nomad node status -self -verbose`  |
| 3       | `vllm-deepseek-r1` | –ó–∞–ø—É—Å—Ç–∏—Ç—å inference      | Health check –ø—Ä–æ—Ö–æ–¥–∏—Ç               |
| 4       | `open-webui`       | Deploy jobspec           | UI –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ 8080                 |
| 5       | Integration        | Smoke test chat          | –û—Ç–≤–µ—Ç –æ—Ç –º–æ–¥–µ–ª–∏ –ø–æ–ª—É—á–µ–Ω             |

## üí• Blast Radius

–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç:

- `vllm-deepseek-r1` –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Üí –ü–æ–ª–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ UI
- ZFS dataset –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ‚Üí –ü–æ—Ç–µ—Ä—è persistent data
- Port 8080 –∑–∞–Ω—è—Ç ‚Üí –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
```

### –ü—Ä–∏–º–µ—Ä 2: `vllm-deepseek-r1` Dependencies

```markdown
## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å     | –¢–∏–ø            | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –ö–æ–Ω—Ç—Ä–∞–∫—Ç                         | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ü—Ä–æ–≤–µ—Ä–∫–∞                  |
| :-------------- | :------------- | :---------- | :------------------------------- | :---------- | :------------------------ |
| `nomad`         | Infrastructure | Upstream    | GPU device plugin                | Critical    | `nomad node status -self` |
| `nvidia-driver` | Infrastructure | Upstream    | CUDA 13.1+                       | Critical    | `nvidia-smi`              |
| `zfs`           | Infrastructure | Upstream    | Dataset `/data/hawk/models/vllm` | High        | Pre-start check           |
| `huggingface`   | Soft           | Upstream    | Model download                   | Medium      | Cached model fallback     |

## üöÄ Deployment Sequence

| –ü–æ—Ä—è–¥–æ–∫ | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç          | –î–µ–π—Å—Ç–≤–∏–µ                 | –ü—Ä–æ–≤–µ—Ä–∫–∞                |
| :------ | :----------------- | :----------------------- | :---------------------- |
| 1       | NVIDIA driver      | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é         | `nvidia-smi`            |
| 2       | Nomad GPU          | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å device plugin  | `nomad node status`     |
| 3       | ZFS dataset        | –°–æ–∑–¥–∞—Ç—å –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | Directory exists        |
| 4       | Model cache        | Pre-download (one-time)  | Downloader job complete |
| 5       | `vllm-deepseek-r1` | Deploy inference         | Health + model loaded   |

## üí• Blast Radius

–≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –Ω–µ –∏–º–µ–µ—Ç downstream –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–ª–∏—è—é—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ API –∫–æ–Ω—Ç—Ä–∞–∫—Ç.

Downstream (–∫–ª–∏–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ API):
- `open-webui` ‚Äî UI –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –í–Ω–µ—à–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—ã (–ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã –∫ –ø–æ—Ä—Ç—É 18000)
```

---

## üîó –°–≤—è–∑—å —Å –î—Ä—É–≥–∏–º–∏ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏

| –°—Ç–∞–Ω–¥–∞—Ä—Ç                                            | –ö–∞–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç                                      |
| :-------------------------------------------------- | :------------------------------------------------------- |
| [Service Specification Standard][standard-services] | –°–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–¥–µ–ª "üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏" —Å Dependency Map         |
| [Feature Specification Standard][standard-features] | Hub –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç Deployment Sequence –∏ Blast Radius |

---

## üìù Changelog

| –î–∞—Ç–∞       | –í–µ—Ä—Å–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏—è                                                                     |
| :--------- | :----- | :---------------------------------------------------------------------------- |
| 2026-02-01 | 1.1.0  | –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ–ª—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, —É—Ç–æ—á–Ω–µ–Ω deployment order, –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–∫—Ç–∏–∫–∏ |
| 2026-02-02 | 1.0.0  | –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞                                               |

---

[standard-services]: ./standard-service-specification.md
[standard-features]: ./standard-feature-specification.md
[backlink-index]: ./INDEX.md
